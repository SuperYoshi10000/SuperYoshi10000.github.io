<script>
    // Loading
    const start = new Date().getTime();
    const time = Math.random() * 4000 + 2000;
    while (new Date().getTime() - start < time) {}
</script>
<title>Preview</title>
<a style="float: right; padding-right: 5px; display: block" href="command.html">Close</a>
<button id="open">Open</button>
<hr/>
<div id="textareastuff"></div>
<br/>
<script>
    var open = document.getElementById("open");
    open.addEventListener("click", async e => {
        // Loading
        const start = new Date().getTime();
        const time = Math.random() * 1000 + 1000;
        while (new Date().getTime() - start < time) {}
        
        var i = document.createElement("input");
        i.type = "file";
        i.multiple = true;
        i.style.display = "none";
        document.body.appendChild(i);
        i.click();
        i.addEventListener("change", async e => {
            var files = i.files;
            if (!files || files.length === 0) return;
            for (var f = 0; f < files.length; f++) {
                var reader = new FileReader();
                reader.readAsText(files[f]);
                reader.onload = function(e) {
                    // Reading
                    const start = new Date().getTime();
                    const time = Math.random() * 1000 + 1000;
                    while (new Date().getTime() - start < time) {}
                    var file = files[f];
                    console.log(f, file);
                    var url = URL.createObjectURL(file);
                    var object = document.createElement("object");
                    object.data = url;
                    object.type = file.type;
                    document.getElementById("textareastuff").appendChild(object);
                };
            }
            document.body.removeChild(i);
        });
    });
    window.addEventListener("keydown", e => {
        if (e.keyCode === 79 && e.ctrlKey) {
            e.preventDefault();
            open.click();
        } else if (e.keyCode === 81 && e.ctrlKey) {
            e.preventDefault();
            document.querySelector("a").click();
        }
    });
</script>
<style>
    body {
        margin: 0;
        padding: 0;
        overflow: hidden;
    }
    #textareastuff {
        width: 100vw;
        height: calc(100vh - 50px);
        resize: none;
    } 
</style>